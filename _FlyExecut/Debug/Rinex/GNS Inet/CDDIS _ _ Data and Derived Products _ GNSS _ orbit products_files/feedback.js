  var feedback=function(){var e=function(e,t){if(t)for(var n in t)e[n]=t[n];return e},t=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1},n=function(e,t){for(var n="",i=0;i<e.length;++i)0!=i&&t&&(n+=t),n+=e[i];return n},i=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{if(!e.attachEvent)throw"Could not subscribe to event "+t;e.attachEvent("on"+t,n)}},o=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},s=function(e){return e.trim?e.trim():e.match(/^\s*(.*?)\s*$/)[1]},r=function(e,i){return classes=(e.className||"").split(/\s+/),-1==t(classes,i)?(classes.push(i),e.className=s(n(classes," ")),!0):!1},a=function(e,i){classes=(e.className||"").split(/\s+/);var o=t(classes,i);return o>-1?(classes.splice(o,1),e.className=s(n(classes," ")),!0):!1},d={initialMouseX:void 0,initialMouseY:void 0,startX:void 0,startY:void 0,draggedObject:void 0,initElement:function(e){"string"==typeof e&&(e=document.getElementById(e)),i(e,"mousedown",d.startDragMouse)},startDragMouse:function(e){console.log(this),d.startDrag(this);var t=(e||window.event,d.getEventPosition(e));return d.initialMouseX=t.pageX,d.initialMouseY=t.pageY,i(document,"mousemove",d.dragMouse),i(document,"mouseup",d.releaseElement),!1},startDrag:function(e){d.draggedObject&&d.releaseElement(),d.startX=e.getBoundingClientRect().left,d.startY=e.getBoundingClientRect().top,console.log("startDrag="+d.startX+", "+d.startY),d.draggedObject=e,r(e,"dragged")},dragMouse:function(e){var t=(e||window.event,d.getEventPosition(e)),n=t.pageX-d.initialMouseX,i=t.pageY-d.initialMouseY;return console.log("dragMouse = "+t.pageX+", "+t.pageY+", "+n+", "+i),d.setPosition(n,i),!1},setPosition:function(e,t){var n=d.startX+e,i=d.startY+t;n=0>n?0:n,i=0>i?0:i,console.log("Setting position "+n+", "+i),d.draggedObject.style.left=n+"px",d.draggedObject.style.top=i+"px"},releaseElement:function(){o(document,"mousemove",d.dragMouse),o(document,"mouseup",d.releaseElement),a(d.draggedObject,"dragged"),d.draggedObject=null},getEventPosition:function(e){var t=e.pageX,n=e.pageY;return void 0===t&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{pageX:t,pageY:n}}},c=function(t){this.options=e({formUrl:"https://fbm.earthdata.nasa.gov/tickets/new?app_name=CDDIS&token=%242a%2410%24hd0ewu108Yl3WMdR6Z.QUOTBnl1HwfFuJ4Lkt7UloJnUR26zpFmIO",iconUrl:"https://fbm.earthdata.nasa.gov/assets/earthdata-feedback-2cc10c2efd32c2e2f3f0a0d4c5370be5.png",dialogHeight:376,dialogWidth:664,showIcon:!0},t);var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href="https://fbm.earthdata.nasa.gov/for/CDDIS/feedback.css";var o=document.getElementsByTagName("head");o.length>0&&o[0].appendChild(n),i(window,"message",this._bind(this._onDialogEvent)),this.options.showIcon&&this.showIcon()};c.prototype.closeForm=function(){this._container&&(this._container.style.display="none",this._iframe.src=this._getFormUrl(),a(this._dialog,"open"),a(this._dialog,"minimized"))},c.prototype.showForm=function(e){var t=this._getContainer();t.style.display="block",window.setTimeout(this._bind(function(){r(this._dialog,"open")}),0),this._iframe.onload=this._bind(function(e){"load"===e.type&&(this._iframe.contentWindow.focus(),this._iframe.onload=null)}),this._iframe.src=this._getFormUrl(e),d.initElement("feedback-dialog")};var l=function(){var e=document.documentElement.clientHeight;return e===document.documentElement.scrollHeight&&(e=document.body.clientHeight),e};c.prototype.showIcon=function(){var e=this._createIcon();document.body.appendChild(e),this._resize("icon",this._bind(function(){var t=window.innerHeight||l();e.style.top=t/2-e.clientHeight/2+"px"})),e.onclick=this._bind(function(e){this.showForm(),e.preventDefault()})},c.prototype._bind=function(e){var t=this;return Function.prototype.bind?e.bind(t):function(){e.apply(t,arguments)}},c.prototype._createIcon=function(){var e=document.createElement("a");e.href="javascript:;",e.id="feedback-link",e.setAttribute("role","button"),e.setAttribute("aria-label","Open the feedback form");var t=document.createElement("img");return t.id="feedback-icon",t.alt="Feedback",t.title="Feedback",t.src=this.options.iconUrl,e.appendChild(t),e},c.prototype._getBrowserDetails=function(){return{agent:navigator.userAgent,href:window.location.href,screenWidth:screen.width,screenHeight:screen.height,pageWidth:document.documentElement.clientWidth,pageHeight:document.documentElement.clientHeight}},c.prototype._getContainer=function(){if(this._container)return this._container;var e=document.createElement("DIV");e.id="feedback-container";var t=document.createElement("DIV");t.id="feedback-overlay",e.appendChild(t);var n=document.createElement("DIV");n.id="feedback-dialog",this._resize("dialog",this._bind(function(){var e=window.innerHeight||l();n.style.top=e/2-this.options.dialogHeight/2+"px",n.style.left=document.documentElement.clientWidth/2-this.options.dialogWidth/2+"px"})),e.appendChild(n);var i=document.createElement("DIV");i.id="feedback-header",n.appendChild(i);var o=document.createElement("A");o.appendChild(document.createTextNode("Close")),o.href="javascript:;",o.title="Close",o.setAttribute("role","button"),o.setAttribute("aria-label","Close the feedback form"),o.onclick=this._bind(this.closeForm),i.appendChild(o);var s=document.createElement("IFRAME");s.id="feedback-iframe",s.scrolling="yes",s.frameBorder=0,n.appendChild(s),this._iframe=s;var r=document.createElement("BUTTON");return r.id="feedback-button-close",r.setAttribute("aria-label","Close the feedback form"),r.appendChild(document.createTextNode("OK")),r.onclick=this._bind(this.closeForm),n.appendChild(r),this._container=e,this._dialog=n,this._close=o,document.body.appendChild(this._container),this._container},c.prototype._getFormUrl=function(e){var t=this._getBrowserDetails();e&&(e.title&&(t.title=e.title),e.custom_note&&(t.custom_note=e.custom_note),e.subject&&(t.subject=e.subject),e.details&&(t.details=e.details),e.metadata&&Object.keys(e.metadata).length&&(t.metadata=JSON.stringify(e.metadata)));var n=this.options.formUrl;for(var i in t)n+="&",n+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]);return n},c.prototype._onDialogEvent=function(e){"feedback.dialog.onSuccess"===e.data&&this._showCloseButton()},c.prototype._onResize=function(e){e(),window.onresize?(origOnResize=window.onresize,window.onresize=function(){origOnResize(),e()}):window.onresize=e},c.prototype._resize=function(e,t){if(t(),this._resizeBindings||(this._resizeBindings={}),this._resizeBindings[e]=t,!this._resizeIsBound){var n=this,i=this._bind(function(){for(var e in n._resizeBindings)n._resizeBindings[e]()});window.onresize?(origOnResize=window.onresize,window.onresize=function(){origOnResize(),i()}):window.onresize=i,this._resizeIsBound=!0}},c.prototype._showCloseButton=function(){this._dialog&&this._close&&this._iframe&&(a("open"),r(this._dialog,"minimized"),a(this._dialog,"dragged"))},c.prototype._stopResize=function(){for(var e in arguments)this._resizeBindings&&this._resizeBindings.hasOwnProperty(e)&&delete this._resizeBindings[e]};var u=null;return{init:function(e){return u=new c(e),feedback=u,u}}}();